1. тип файла
IPTV - закладка IPTV, DVBS -- закладка DVB-S, DVBC -- все, кроме указанных двух закладок.

# определ€ем тип файла --------------------
ptype <- case_when(
  "IPTV" %in% sheets  ~ "iptv",
  "DVB-S" %in% sheets ~ "dvbs",
  length(sheets) > 30 ~ "dvbc",
  TRUE                ~ "unknown"
)

2.  олонки по совокупности
row_num  -- номер строки # в excel, дл€ указани€ места ошибки
date     -- берем из имени файла
city     -- актуально дл€ DVBC, берем из имени закладки
type     -- тип технологии
title    -- название канала
epg_id   -- EPG идентификатор
timezone -- актуально дл€ DVBS, часова€ зона спутника

3. ѕо€снени€ внизу IPTV/DVBS отрезаем по колонке "ѕозици€ (LCN)"/"LCN", она должна быть заполнена (не NA)

4.  аналы с названием="–езерв" сразу идет в отброс (предлагаю опустить продолжение "и epg_id='-'?")



P.S.
ѕри преобразовани€х может получитьс€ така€ ерунда:
as.numeric('-')
[1] NA
Warning message:
NAs introduced by coercion


